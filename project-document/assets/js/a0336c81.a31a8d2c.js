"use strict";(self.webpackChunkproject_document=self.webpackChunkproject_document||[]).push([[861],{3905:(t,e,a)=>{a.d(e,{Zo:()=>m,kt:()=>u});var r=a(7294);function n(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){n(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function o(t,e){if(null==t)return{};var a,r,n=function(t,e){if(null==t)return{};var a,r,n={},l=Object.keys(t);for(r=0;r<l.length;r++)a=l[r],e.indexOf(a)>=0||(n[a]=t[a]);return n}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)a=l[r],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}var p=r.createContext({}),d=function(t){var e=r.useContext(p),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},m=function(t){var e=d(t.components);return r.createElement(p.Provider,{value:e},t.children)},k="mdxType",s={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},g=r.forwardRef((function(t,e){var a=t.components,n=t.mdxType,l=t.originalType,p=t.parentName,m=o(t,["components","mdxType","originalType","parentName"]),k=d(a),g=n,u=k["".concat(p,".").concat(g)]||k[g]||s[g]||l;return a?r.createElement(u,i(i({ref:e},m),{},{components:a})):r.createElement(u,i({ref:e},m))}));function u(t,e){var a=arguments,n=e&&e.mdxType;if("string"==typeof t||n){var l=a.length,i=new Array(l);i[0]=g;var o={};for(var p in e)hasOwnProperty.call(e,p)&&(o[p]=e[p]);o.originalType=t,o[k]="string"==typeof t?t:n,i[1]=o;for(var d=2;d<l;d++)i[d]=a[d];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}g.displayName="MDXCreateElement"},3822:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>p,contentTitle:()=>i,default:()=>s,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var r=a(7462),n=(a(7294),a(3905));const l={},i="DynamoDB Design",o={unversionedId:"database/database",id:"database/database",title:"DynamoDB Design",description:"This system use DynamoDB.",source:"@site/docs/database/database.md",sourceDirName:"database",slug:"/database/",permalink:"/nishiki-documents/project-document/database/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ER Diagram",permalink:"/nishiki-documents/project-document/database/er-diagram"}},p={},d=[{value:"Table Configs",id:"table-configs",level:2},{value:"Table Structure",id:"table-structure",level:2},{value:"Key",id:"key",level:3},{value:"Attributes",id:"attributes",level:3},{value:"Global Secondary Index (GSI)",id:"global-secondary-index-gsi",level:2},{value:"UserAndGroupRelations",id:"userandgrouprelations",level:3},{value:"JoinLink",id:"joinlink",level:3},{value:"Contexts",id:"contexts",level:2},{value:"User",id:"user",level:3},{value:"Group",id:"group",level:3},{value:"Container",id:"container",level:3},{value:"Foods",id:"foods",level:4},{value:"Access Pattern",id:"access-pattern",level:2},{value:"Supplement",id:"supplement",level:3}],m={toc:d},k="wrapper";function s(t){let{components:e,...a}=t;return(0,n.kt)(k,(0,r.Z)({},m,a,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"dynamodb-design"},"DynamoDB Design"),(0,n.kt)("p",null,"This system use DynamoDB."),(0,n.kt)("h2",{id:"table-configs"},"Table Configs"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Table Name"),": NishikiTable\n",(0,n.kt)("strong",{parentName:"p"},"Deletion Policy"),": Retain (In develop environment, Delete)"),(0,n.kt)("h2",{id:"table-structure"},"Table Structure"),(0,n.kt)("h3",{id:"key"},"Key"),(0,n.kt)("p",null,"Partition Key is mostly ID of the entity.\nSort key is normally, explains the type of data, if the data is about User, the sort key is USER. But this is relative."),(0,n.kt)("h3",{id:"attributes"},"Attributes"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Note"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"UserId"),(0,n.kt)("td",{parentName:"tr",align:"left"},"String"),(0,n.kt)("td",{parentName:"tr",align:"left"},"UUID")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"UserName"),(0,n.kt)("td",{parentName:"tr",align:"left"},"String"),(0,n.kt)("td",{parentName:"tr",align:"left"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"EMailAddress"),(0,n.kt)("td",{parentName:"tr",align:"left"},"String"),(0,n.kt)("td",{parentName:"tr",align:"left"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"GroupId"),(0,n.kt)("td",{parentName:"tr",align:"left"},"String"),(0,n.kt)("td",{parentName:"tr",align:"left"},"UUID")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"GroupName"),(0,n.kt)("td",{parentName:"tr",align:"left"},"String"),(0,n.kt)("td",{parentName:"tr",align:"left"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"LinkExpiryDatetime"),(0,n.kt)("td",{parentName:"tr",align:"left"},"String"),(0,n.kt)("td",{parentName:"tr",align:"left"},"ISO 8601 date and time")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ContainerId"),(0,n.kt)("td",{parentName:"tr",align:"left"},"String"),(0,n.kt)("td",{parentName:"tr",align:"left"},"UUID")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ContainerName"),(0,n.kt)("td",{parentName:"tr",align:"left"},"String"),(0,n.kt)("td",{parentName:"tr",align:"left"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Foods"),(0,n.kt)("td",{parentName:"tr",align:"left"},"List","[Object]"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("a",{parentName:"td",href:"/database#foods"},"Object Detail"))))),(0,n.kt)("h2",{id:"global-secondary-index-gsi"},"Global Secondary Index (GSI)"),(0,n.kt)("h3",{id:"userandgrouprelations"},"UserAndGroupRelations"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"GSI Name"),": UserAndGroupRelationship",(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("strong",{parentName:"p"},"Projection Type"),": KEY_ONLY"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Key"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Attribute"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"PK"),(0,n.kt)("td",{parentName:"tr",align:"left"},"GroupId")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"SK"),(0,n.kt)("td",{parentName:"tr",align:"left"},"UserId")))),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"This index is used for the access pattern of retrieving a list of users by the Group ID.\nThe reason for not having Container and Group relation GSI, similar to User and Group relation, is that there are few chances to query groups by the container.")),(0,n.kt)("h3",{id:"joinlink"},"JoinLink"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"GSI Name"),": JoinLinkDatetime",(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("strong",{parentName:"p"},"Projection Type"),": KEY_ONLY"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Key"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Attribute"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"PK"),(0,n.kt)("td",{parentName:"tr",align:"left"},"GroupId")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"SK"),(0,n.kt)("td",{parentName:"tr",align:"left"},"LinkExpiryDatetime")))),(0,n.kt)("h2",{id:"contexts"},"Contexts"),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"The {} means that the value inside it will be dynamic value.")),(0,n.kt)("h3",{id:"user"},"User"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"PK"),": User ID (UUID)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"SK"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Detail"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Attributes"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"User"),(0,n.kt)("td",{parentName:"tr",align:"left"},"User Data"),(0,n.kt)("td",{parentName:"tr",align:"left"},"UserName, EMailAddress")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Group#{GroupID}"),(0,n.kt)("td",{parentName:"tr",align:"left"},"The group user belong to"),(0,n.kt)("td",{parentName:"tr",align:"left"},"GroupId")))),(0,n.kt)("h3",{id:"group"},"Group"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"PK"),": Group ID (UUID)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"SK"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Detail"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Attributes"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Group"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Group Data"),(0,n.kt)("td",{parentName:"tr",align:"left"},"GroupName, Users")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Container#{ContainerID}"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Container Data"),(0,n.kt)("td",{parentName:"tr",align:"left"},"ContainerId")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"LinkExpiryDatetime#{Datetime}"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Join Link Expiry Datetime"),(0,n.kt)("td",{parentName:"tr",align:"left"},"LinkExpiryDatetime, GroupId")))),(0,n.kt)("h3",{id:"container"},"Container"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"PK"),": Container ID (UUID)"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"SK"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Detail"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Attribute"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Container"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Container Data"),(0,n.kt)("td",{parentName:"tr",align:"left"},"ContainerName, Foods")))),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Container can be defined in the Group context using PK as group ID and SK as Container#{ContainerID}.\nWhile it makes the item structure more straightforward, it requires the use of a Global secondary Index(GSI) to retrieve container data using the container ID."),(0,n.kt)("p",{parentName:"admonition"},"In this system, updating food operations are the most frequent, and in DynamoDB, writing operations are more than 5 times more expensive than reading.\nUsing GSI for writing operations result in twice the cost which is not cost-effective. Hence, we prioritize cost efficiency and opted to separate the container from the group.")),(0,n.kt)("h4",{id:"foods"},"Foods"),(0,n.kt)("p",null,"Food is the object."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-object"},"{\n    FoodId: string (UUID),\n    Name: String | null,\n    Unit: String | null,\n    Quantity: Number | null,\n    Category: String | null,\n    Expiry: String (Datetime) | null,\n    CreatedDatetime: String (Datetime)\n}\n")),(0,n.kt)("h2",{id:"access-pattern"},"Access Pattern"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Access pattern name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Key (PK/SK)"),(0,n.kt)("th",{parentName:"tr",align:"left"},"How to Access"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Detail"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Context"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"GetUser"),(0,n.kt)("td",{parentName:"tr",align:"left"},"UserId / User"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Get"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Get a single user data"),(0,n.kt)("td",{parentName:"tr",align:"left"},"User")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ListOfUsersGroup"),(0,n.kt)("td",{parentName:"tr",align:"left"},"UserId / Group#"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Query"),(0,n.kt)("td",{parentName:"tr",align:"left"},"List of groups user belonging to"),(0,n.kt)("td",{parentName:"tr",align:"left"},"User")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"GetGroup"),(0,n.kt)("td",{parentName:"tr",align:"left"},"GroupId / Group"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Get"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Get a group data"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Group")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ListOfContainers"),(0,n.kt)("td",{parentName:"tr",align:"left"},"GroupId / Container#"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Query"),(0,n.kt)("td",{parentName:"tr",align:"left"},"List of containers belonging to group"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Group")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ListOfUsersInGroup"),(0,n.kt)("td",{parentName:"tr",align:"left"},"GroupId"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Query against GSI"),(0,n.kt)("td",{parentName:"tr",align:"left"},"List of users belonging to group"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Group")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"GetContainer"),(0,n.kt)("td",{parentName:"tr",align:"left"},"ContainerId / Container"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Get"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Get a container data"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Container")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ListOfJoinLinkExpiryDatetime"),(0,n.kt)("td",{parentName:"tr",align:"left"},"None (Datetime)"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Filter against GSI"),(0,n.kt)("td",{parentName:"tr",align:"left"},"List of join group link expiry Datetime"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Group")))),(0,n.kt)("h3",{id:"supplement"},"Supplement"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"ListOfJoinLinkExpiryDatetime")),(0,n.kt)("p",null,"The expiry date means before the time of calling this one."))}s.isMDXComponent=!0}}]);